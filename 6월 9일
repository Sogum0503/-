1. 조인조건 없이 테이블을 이어붙이기 


스터디원분이 해당 쿼리가 돌아가지 않는다며 도움을 요청하셨다.

WITH sub_table AS (
  SELECT 
    t1.station_id AS station_id,
    t1.name AS name,
    2 * 6356 * asin(sqrt(pow(sin((radians(t1.lat) - radians(t2.lat)) / 2 ), 2) +
    cos(radians(t1.lat)) * cos(radians(t2.lat)) *
    pow(sin((radians(t1.lng) - radians(t2.lng)) / 2), 2))) AS distance
  FROM station t1
  INNER JOIN station t2 on t1.station_id = t2.station_id 
  WHERE t1.updated_at < t2.updated_at)
  
SELECT station_id
        ,name
FROM sub_table 
WHERE distance <= 0.3 
GROUP BY station_id,name
having count(*) >= 5


