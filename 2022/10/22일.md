### 프로그래머스 
#### 상품을 구매한 회원 비율 구하기

```sql
with temp as (
    select user_id,
            count(*) over() as cnt_2021 -- 각 row
    from user_info 
    where year(joined) = '2021')

select year(sales_date) as year,
        month(sales_date) as month,
        count(distinct o.user_id) as puchased_users,
        round(count(distinct o.user_id)/cnt_2021,1) as puchased_ratio
from temp t 
    inner join online_sale o on t.user_id = o.user_id 
group by 1,2
order by 1,2
```
