### LEETCODE문제풀이 
-----------
#### [2084#_MEDIUM] Drop Type 1 Orders for Customers With Type 0 Orders

최종 쿼리
```sql
with temp as(
    select *,
            rank() over(partition by customer_id order by order_type) as rnk
    from orders 
)

select order_id,
       customer_id,
        order_type
from temp 
where rnk = 1
```
풀이 과정 
```
지금 내가 출력해야 하는 값은 아래와 같다 
+----------+-------------+------------+
| order_id | customer_id | order_type | 출력해야함 
+----------+-------------+------------+
| 1        | 1           | 0          | O
| 2        | 1           | 0          | O 
| 11       | 2           | 0          | O 
| 12       | 2           | 1          | X 
| 21       | 3           | 1          | X 
| 22       | 3           | 0          | O
| 31       | 4           | 1          | O
| 32       | 4           | 1          | O 
+----------+-------------+------------+

즉, 더미 변수값을 부여하는 것 처럼 출력해야 하는 값에는 1 값을, 출력하지 말아야 하는 값에는 0 값을 넣는 식으로 진행할 수는 없을까?
=> rank() 함수를 생각해 볼 수 있다.

rank() over(partition by customer_id order by order_type) as rnk 라는 값을 부여하게 되면 출력하고 싶은 값에는 1을, 출력하고 싶지 않는 값에는 2 값을 부여할 수 있다.

왜냐?
- 어떤 customer는 order_type을 0과 1 모두 가지고 있다 가정했을 때, 그는 rnk값을 1과 2를 부여받게 된다. 
- 어떤 custoemr는 order_type을 0 혹은 1만 가지고 있다 가정했을 때, 그는 rnk값을 오직 1만 부여받게 된다.

이렇게 되었을 때 나는 where절에 rnk=1 조건만 넣게 되면 출력하고 싶은 값만 뽑아올 수 있게 되는거. 
```
