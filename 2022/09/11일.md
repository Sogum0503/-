### LEETCODE 문제풀이 

#### [1369#_HARD] Get the Second Most Recent Activity

최종 쿼리 
```sql
with temp as(
select *,
        row_number() over(partition by username order by startdate desc) as num,
        count(username) over(partition by username) as cnt_rnk
from useractivity)

select username,
        activity,
        startDate,
        endDate
from temp
where (num = 2 and cnt_rnk >= 2) or (num=1 and cnt_rnk = 1)
```

풀이 과정
```
row_number() over(partition by username order by startDate desc)를 활용해서 최근 두 번재 activity 출력 

count(username) over(partition by username)을 활용해서 전체 테이블에서 해당 username이 몇 번 나오는지 확인, 
한 번만 출력되는 username이 있다면 그는 하나의 활동만 한 유저일 것이기 때문에 그대로 출력 
```
