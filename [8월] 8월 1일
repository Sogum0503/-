[1264#_MEDIUM] Page Recommendations

SELECT distinct page_id recommended_page
FROM Friendship f
     LEFT JOIN (SELECT *
                FROM Likes
                WHERE page_id NOT IN (SELECT page_id
                                      FROM LIKES
                                      WHERE user_id = 1)
                )l 
          ON f.user2_id = l.user_id
          OR f.user1_id = l.user_id
WHERE (f.user1_id = 1 OR f.user2_id = 1)
AND page_id is not null

